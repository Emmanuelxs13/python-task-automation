"""
Vulnerability schemas for request/response validation
"""

from pydantic import BaseModel, Field
from datetime import datetime
from enum import Enum


class SeverityEnum(str, Enum):
    """Vulnerability severity levels"""
    CRITICAL = "critical"
    HIGH = "high"
    MEDIUM = "medium"
    LOW = "low"
    INFO = "info"


class VulnerabilityCreate(BaseModel):
    """Schema for creating a vulnerability"""
    scan_id: int
    severity: SeverityEnum
    title: str = Field(..., min_length=1, max_length=200)
    description: str = Field(..., min_length=1)
    recommendation: str | None = None


class VulnerabilityResponse(BaseModel):
    """Schema for vulnerability response"""
    id: int
    scan_id: int
    severity: SeverityEnum
    title: str
    description: str
    recommendation: str | None
    created_at: datetime

    class Config:
        from_attributes = True
